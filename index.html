<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CZK → AED</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:-apple-system;background:#f5f7fa;margin:0;padding:20px}
.card{max-width:600px;margin:auto;background:#fff;padding:25px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
h1{text-align:center}
.rate{text-align:center;margin:10px 0;font-weight:600}
input{width:100%;padding:12px;font-size:18px;border-radius:10px;border:1px solid #ddd;margin-bottom:10px}
.result{text-align:center;font-size:22px;font-weight:bold;margin-bottom:15px}
.buttons{display:flex}
button{flex:1;margin:5px;padding:10px;border:none;border-radius:8px;background:#e9eef5;cursor:pointer}
button.active{background:#007aff;color:white}
canvas{margin-top:15px}
</style>
</head>
<body>

<div class="card">
<h1>CZK → AED</h1>
<div class="rate" id="rate">Načítám kurz...</div>
<input type="number" id="amount" value="1000">
<div class="result" id="result"></div>

<div class="buttons">
<button onclick="loadHistory(1,this)">Dnes</button>
<button onclick="loadHistory(7,this)" class="active">7 dní</button>
<button onclick="loadHistory(30,this)">30 dní</button>
</div>

<canvas id="chart"></canvas>
</div>

<script>
let chart;
let currentRate=0;

async function fetchRate(){
try{
const res=await fetch("https://api.frankfurter.app/latest?from=CZK&to=AED");
const data=await res.json();
currentRate=data.rates.AED;
document.getElementById("rate").innerText="Aktuální kurz: 1 CZK = "+currentRate.toFixed(4)+" AED";
calculate();
}catch(e){
document.getElementById("rate").innerText="Nelze načíst kurz";
}
}

function calculate(){
const amount=document.getElementById("amount").value;
document.getElementById("result").innerText=(amount*currentRate).toFixed(2)+" AED";
}

async function loadHistory(days,btn){
document.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");

const end=new Date();
const start=new Date();
start.setDate(end.getDate()-days);

const format=d=>d.toISOString().split("T")[0];

const url=`https://api.frankfurter.app/${format(start)}..${format(end)}?from=CZK&to=AED`;

const res=await fetch(url);
const data=await res.json();

const labels=Object.keys(data.rates);
const values=labels.map(date=>data.rates[date].AED);

if(chart)chart.destroy();

chart=new Chart(document.getElementById("chart"),{
type:"line",
data:{labels:labels,datasets:[{data:values,tension:.3,fill:false}]},
options:{responsive:true,plugins:{legend:{display:false}}}
});
}

document.getElementById("amount").addEventListener("input",calculate);

fetchRate();
loadHistory(7,document.querySelector(".active"));
setInterval(fetchRate,60000);
</script>

</body>
</html>

